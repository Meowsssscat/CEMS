{% extends "base_osas.html" %}

{% block title %}Postpone Event{% endblock %}

{% block content %}
<div class="page-header">
  <h1>Postpone/Reschedule Event</h1>
  <a href="{{ url_for('osas_event_management.view_all_events') }}" class="btn-back">‚Üê Back to Event Management</a>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<div class="current-event-info">
  <h2>Current Event Details</h2>
  <div class="info-grid">
    <div class="info-item">
      <strong>Event Name:</strong> {{ event.event_name }}
    </div>
    <div class="info-item">
      <strong>Department:</strong> 
      {% if event.users.department_name %}
        {{ event.users.department_name }}
      {% else %}
        {{ event.users.full_name }}
      {% endif %}
    </div>
    <div class="info-item">
      <strong>Current Date:</strong> {{ event.date }}
    </div>
    <div class="info-item">
      <strong>Current Time:</strong> {{ event.start_time }} - {{ event.end_time }}
    </div>
    <div class="info-item">
      <strong>Location:</strong> {{ event.location }}
    </div>
    <div class="info-item">
      <strong>Status:</strong> 
      <span class="status-badge status-{{ event.status.lower() }}">{{ event.status }}</span>
    </div>
  </div>
</div>

<div class="form-container">
  <h2>New Schedule</h2>
  <form method="POST" class="postpone-form">
    
    <div class="form-group">
      <label for="new_date">New Event Date *</label>
      <input type="date" id="new_date" name="new_date" required value="{{ event.date }}">
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="new_start_time">New Start Time *</label>
        <input type="time" id="new_start_time" name="new_start_time" required value="{{ event.start_time }}">
      </div>

      <div class="form-group">
        <label for="new_end_time">New End Time *</label>
        <input type="time" id="new_end_time" name="new_end_time" required value="{{ event.end_time }}">
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn-primary">Confirm Reschedule</button>
      <a href="{{ url_for('osas_event_management.view_all_events') }}" class="btn-secondary">Cancel</a>
    </div>

  </form>
</div>

<div class="info-box">
  <h3>Important Notes:</h3>
  <ul>
    <li><strong>Schedule Conflict Check:</strong> System will automatically check for conflicts with the new date/time</li>
    <li><strong>Same Location:</strong> The event location will remain the same</li>
    <li><strong>Registered Students:</strong> All current registrations will be maintained</li>
    <li><strong>Department Notification:</strong> Department should be notified about the schedule change</li>
    <li><strong>Administrative Override:</strong> As OSAS, you can reschedule any event</li>
    <li>If a conflict is detected, the system will reject the reschedule and you'll need to choose a different time</li>
  </ul>
</div>

{% endblock %}